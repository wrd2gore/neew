<html>
<head>
  <style>
    :root {
      --primary-color: #ff8c94; /* Soft coral for main elements */
      --secondary-color: #ffb3b8; /* Light pink for contrast */
      --accent-color: #ffd1d5; /* Pale pink for highlights */
      --animation-duration: 7s;
    }

    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      font-family: 'Arial', sans-serif;
      overflow: hidden;
      perspective: 1000px;
      background: url('background.png') no-repeat center center fixed;
      background-size: cover;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      cursor: url('cursor.png') 16 16, auto;
    }

    /* Animated cursor effect */
    body:hover {
      animation: cursorBounce 1.5s infinite ease-in-out;
    }

    @keyframes cursorBounce {
      0%, 100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.2) rotate(10deg);
      }
    }

    /* Pointer (trailing image) */
    .pointer {
      position: fixed;
      width: 16px;
      height: 16px;
      background: url('pointer.png') no-repeat center center;
      background-size: contain;
      pointer-events: none;
      opacity: 0.7;
      box-shadow: 0 0 10px var(--primary-color);
      transition: transform 0.1s ease-out, opacity 0.3s ease-out;
      z-index: 1000;
    }

    .container {
      position: relative;
      transform-style: preserve-3d;
      z-index: 1;
    }

    .mary {
      font-size: 6rem;
      font-weight: bold;
      color: #333;
      text-transform: uppercase;
      animation: glow 2s ease-in-out infinite alternate;
      position: relative;
      user-select: none;
      text-align: center;
    }

    .card-container.active .mary,
    .container .mary.card-hidden {
      display: none;
    }

    .mary span {
      display: inline-block;
      transition: transform 0.3s, color 0.3s;
      cursor: url('cursor.png') 16 16, pointer;
    }

    .mary span:hover {
      transform: translateY(-20px) scale(1.2);
      color: var(--accent-color);
    }

    @keyframes glow {
      from {
        text-shadow: 0 0 10px #fff,
                     0 0 20px var(--primary-color),
                     0 0 30px var(--secondary-color);
        transform: scale(1) rotateX(0deg) translateZ(0px);
      }
      to {
        text-shadow: 0 0 20px #fff,
                     0 0 30px var(--accent-color),
                     0 0 40px var(--primary-color);
        transform: scale(1.1) rotateX(10deg) translateZ(50px);
      }
    }

    .particle {
      position: absolute;
      width: 5px;
      height: 5px;
      background: var(--accent-color);
      border-radius: 50%;
      pointer-events: none;
      opacity: 0;
      animation: float 1s ease-out forwards;
    }

    @keyframes float {
      0% {
        transform: translate(0, 0);
        opacity: 1;
      }
      100% {
        transform: translate(var(--tx), var(--ty));
        opacity: 0;
      }
    }

    .mirror {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      transform: scaleY(-0.2);
      opacity: 0.3;
      filter: blur(2px);
      color: #333;
      font-size: 6rem;
      font-weight: bold;
      text-transform: uppercase;
      text-align: center;
    }

    .card-container {
      position: fixed;
      perspective: 1000px;
      z-index: 5;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .card-container.active {
      opacity: 1;
      pointer-events: all;
    }

    .card {
      width: 500px;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(245, 245, 245, 0.9));
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid var(--accent-color);
      border-radius: 20px;
      padding: 30px;
      color: #333;
      transform-style: preserve-3d;
      transition: transform 0.2s ease;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .header {
      display: flex;
      align-items: center;
      gap: 20px;
      margin-bottom: 30px;
    }

    .profile-pic {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      overflow: hidden;
      background: #f5f5f5;
      border: 3px solid var(--accent-color);
      box-shadow: 0 0 10px var(--accent-color);
    }

    .profile-pic img {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      object-fit: cover;
    }

    .username {
      font-size: 32px;
      color: #333;
      text-shadow: 0 0 5px var(--primary-color);
    }

    .tags {
      display: flex;
      gap: 15px;
      margin-bottom: 25px;
    }

    .tag {
      background: #f5f5f5;
      padding: 8px 15px;
      border-radius: 20px;
      font-size: 15px;
      color: #333;
      border: 1px solid var(--accent-color);
      box-shadow: 0 0 8px var(--accent-color);
      transition: transform 0.2s ease;
    }

    .tag:hover {
      transform: scale(1.1);
    }

    .location {
      display: flex;
      align-items: center;
      gap: 8px;
      color: #555;
      font-size: 18px;
      margin-bottom: 25px;
      text-shadow: 0 0 5px var(--secondary-color);
    }

    .icons {
      display: flex;
      gap: 15px;
      margin-bottom: 30px;
    }

    .icon {
      position: relative;
      display: inline-block;
      transition: transform 0.3s ease;
    }

    .icon img {
      width: 45px;
      height: 45px;
      object-fit: cover;
      border-radius: 50%;
      border: 3px solid var(--accent-color);
      box-shadow: 0 0 10px var(--accent-color);
    }

    .icon:hover {
      transform: scale(1.3);
    }

    .tooltip {
      position: absolute;
      bottom: 50px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(245, 245, 245, 0.9);
      color: #333;
      font-size: 13px;
      padding: 8px 12px;
      border-radius: 8px;
      border: 1px solid var(--accent-color);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease, transform 0.3s ease;
      white-space: nowrap;
      z-index: 10;
      box-shadow: 0 0 8px var(--accent-color);
    }

    .icon:hover .tooltip {
      opacity: 1;
      transform: translateX(-50%) translateY(-5px);
    }

    .player {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(245, 245, 245, 0.8));
      padding: 20px;
      border-radius: 15px;
      margin-bottom: 20px;
      border: 1px solid var(--accent-color);
      box-shadow: 0 0 10px var(--secondary-color);
    }

    .song-title {
      color: #555;
      margin-bottom: 15px;
      font-size: 18px;
      display: flex;
      justify-content: space-between;
      text-shadow: 0 0 5px var(--secondary-color);
    }

    .song-title a {
      color: #555;
      text-decoration: none;
    }

    .song-title a:hover {
      color: var(--accent-color);
    }

    .time-display {
      font-size: 14px;
      color: #777;
    }

    .view-counter {
      font-size: 16px;
      color: #555;
      margin-top: 10px;
      text-shadow: 0 0 5px var(--secondary-color);
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .view-counter img {
      width: 20px;
      height: 20px;
      object-fit: contain;
    }

    .progress-bar {
      background: #f5f5f5;
      height: 8px;
      border-radius: 4px;
      position: relative;
      cursor: pointer;
      margin-bottom: 15px;
      border: 1px solid var(--accent-color);
    }

    .progress {
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      width: 0%;
      background: var(--accent-color);
      border-radius: 4px;
      transition: width 0.1s ease;
      box-shadow: 0 0 8px var(--accent-color);
    }

    .volume-controls {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-top: 10px;
    }

    .volume-slider {
      width: 120px;
      height: 5px;
      -webkit-appearance: none;
      background: #f5f5f5;
      border-radius: 3px;
      outline: none;
      border: 1px solid var(--accent-color);
    }

    .volume-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 14px;
      height: 14px;
      background: var(--accent-color);
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 0 8px var(--accent-color);
    }
  </style>
</head>
<body>
  <div class="container" style="transform: rotateY(-15.1deg) rotateX(6.21deg);">
    <div class="mary"><span>m</span><span>a</span><span>r</span><span>y</span></div>
    <div class="mary mirror"></div>
  </div>
  <div class=" card-container">
    <div class="card">
      <div class="header">
        <div class="profile-pic"><img src="pfp.png" alt="Profile Picture"></div>
        <div class="username">@gyudoll</div>
      </div>
      <div class="tags"><span class="tag">#metallover</span><span class="tag">#radiohead >///<</span></div>
      <div class="location"><span>father into your hands, why have you forsaken me</span></div>
      <div class="icons">
        <div class="icon"><a href="https://discord.com/users/catgirlplush"><img src="discord.png" alt="Discord Icon" /></a><div class="tooltip">@catgirlplush</div></div>
        <div class="icon"><a href="https://www.roblox.com/users/738048392/profile?friendshipSourceType=PlayerSearch"><img src="roblox.png" alt="Roblox Icon" /></a><div class="tooltip">mae</div></div>
        <div class="icon"><a href="https://open.spotify.com/user/bok0cvekss3x3ya1goxv12frt?si=a9ae8660c0ab4472&nd=1&dlsi=3a145ada9c194915"><img src="spotify.png" alt="Spotify Icon" /></a><div class="tooltip">Mary&lt;3</div></div>
        <div class="icon"><a href="https://www.instagram.com/deadinthedarkroom"><img src="instagram.png" alt="Instagram Icon" /></a><div class="tooltip">@deadinthedarkroom</div></div>
      </div>
      <div class="player">
        <div class="song-title"><a href="https://open.spotify.com/user/bok0cvekss3x3ya1goxv12frt?si=a9ae8660c0ab4472&nd=1&dlsi=3a145ada9c194915" target="_blank">So This Is Love - Cinderella</a><span class="time-display">0:00 / 0:00</span></div>
        <div class="progress-bar"><div class="progress"></div></div>
        <div class="volume-controls"><span>>///<</span><input type="range" class="volume-slider" min="0" max="100" value="50"></div>
        <div class="view-counter"><img src="eye.png" alt="Eye Icon"><span id="viewCount">0</span></div>
      </div>
    </div>
  </div>
  <div class="pointer"></div>
  <audio id="musicPlayer" src="song.mp3"></audio>

  <script>
    // Initialize view counter
    const viewCountElement = document.getElementById('viewCount');
    let viewCount = parseInt(localStorage.getItem('viewCount') || '0', 10);
    viewCountElement.textContent = viewCount;

    // Simulate unique visitor tracking with sessionStorage
    const hasViewed = sessionStorage.getItem('hasViewed');

    // Split text into spans and set mirror text
    const text = "mary";
    const mary = document.querySelector('.mary');
    const mirror = document.querySelector('.mirror');
    mary.innerHTML = [...text].map(char => `<span>${char}</span>`).join('');
    mirror.innerHTML = [...text].map(char => `<span>${char}</span>`).join('');

    // Particle system
    const particlePool = [];
    const POOL_SIZE = 20;
    const container = document.querySelector('.container');

    for (let i = 0; i < POOL_SIZE; i++) {
      const particle = document.createElement('div');
      particle.className = 'particle';
      particle.style.display = 'none';
      container.appendChild(particle);
      particlePool.push(particle);
    }

    function getParticle() {
      return particlePool.find(p => p.style.display === 'none') || null;
    }

    let lastMouseX = 0;
    let lastMouseY = 0;

    function createParticle(x, y) {
      const particle = getParticle();
      if (!particle) return;

      const angle = Math.random() * Math.PI * 2;
      const distance = Math.random() * 50 + 25;
      const tx = Math.cos(angle) * distance;
      const ty = Math.sin(angle) * distance;
      
      particle.style.display = 'block';
      particle.style.left = (x - container.offsetLeft) + 'px';
      particle.style.top = (y - container.offsetTop) + 'px';
      particle.style.setProperty('--tx', `${tx}px`);
      particle.style.setProperty('--ty', `${ty}px`);
      
      setTimeout(() => {
        particle.style.display = 'none';
      }, 1000);
    }

    // Pointer (trailing image) movement
    const pointer = document.querySelector('.pointer');
    document.addEventListener('mousemove', (e) => {
      pointer.style.transform = `translate(${e.clientX - 8}px, ${e.clientY - 8}px)`;
      pointer.style.opacity = '0.7';
    });

    document.addEventListener('mouseout', () => {
      pointer.style.opacity = '0';
    });

    // Throttled mousemove handler for particles and container rotation
    let ticking = false;
    document.addEventListener('mousemove', (e) => {
      if (!ticking) {
        window.requestAnimationFrame(() => {
          const dx = e.clientX - lastMouseX;
          const dy = e.clientY - lastMouseY;
          const distance = Math.sqrt(dx * dx + dy * dy);
          
          if (distance > 5) {
            createParticle(e.clientX, e.clientY);
            lastMouseX = e.clientX;
            lastMouseY = e.clientY;
          }

          const xAxis = (window.innerWidth / 2 - e.clientX) / 50;
          const yAxis = (window.innerHeight / 2 - e.clientY) / 50;
          container.style.transform = `rotateY(${xAxis}deg) rotateX(${yAxis}deg)`;
          
          ticking = false;
        });
        ticking = true;
      }
    });

    // Card interaction
    const cardContainer = document.querySelector('.card-container');
    const card = document.querySelector('.card');
    const musicPlayer = document.getElementById('musicPlayer');
    const progressBar = document.querySelector('.progress');
    const volumeSlider = document.querySelector('.volume-slider');
    const timeDisplay = document.querySelector('.time-display');

    function formatTime(seconds) {
      const minutes = Math.floor(seconds / 60);
      const remainingSeconds = Math.floor(seconds % 60);
      return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;
    }

    let audioFadeInterval;
    function fadeAudioIn() {
      clearInterval(audioFadeInterval);
      const targetVolume = volumeSlider.value / 100;
      musicPlayer.volume = 0;
      musicPlayer.play().catch(e => console.error("Audio play failed:", e));

      audioFadeInterval = setInterval(() => {
        if (musicPlayer.volume < targetVolume - 0.01) {
          musicPlayer.volume = Math.min(musicPlayer.volume + 0.006, targetVolume);
        } else {
          musicPlayer.volume = targetVolume;
          clearInterval(audioFadeInterval);
        }
      }, 50);
    }

    mary.querySelectorAll('span').forEach(span => {
      span.addEventListener('click', () => {
        cardContainer.classList.toggle('active');
        if (cardContainer.classList.contains('active')) {
          // Increment view count only if this is a new visitor
          if (!hasViewed) {
            viewCount++;
            localStorage.setItem('viewCount', viewCount);
            viewCountElement.textContent = viewCount;
            sessionStorage.setItem('hasViewed', 'true');
          }
          fadeAudioIn();
        } else {
          musicPlayer.pause();
          musicPlayer.currentTime = 0;
          clearInterval(audioFadeInterval);
        }
      });
    });

    musicPlayer.addEventListener('loadedmetadata', () => {
      timeDisplay.textContent = `0:00 / ${formatTime(musicPlayer.duration)}`;
      musicPlayer.volume = volumeSlider.value / 100;
    });

    musicPlayer.addEventListener('timeupdate', () => {
      if (!musicPlayer.duration) return;
      const progress = (musicPlayer.currentTime / musicPlayer.duration) * 100;
      progressBar.style.width = `${progress}%`;
      timeDisplay.textContent = `${formatTime(musicPlayer.currentTime)} / ${formatTime(musicPlayer.duration)}`;
    });

    volumeSlider.addEventListener('input', (e) => {
      musicPlayer.volume = e.target.value / 100;
    });

    document.querySelector('.progress-bar').addEventListener('click', (e) => {
      if (!musicPlayer.duration) return;
      const rect = e.target.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const percentage = x / rect.width;
      musicPlayer.currentTime = percentage * musicPlayer.duration;
    });

    card.addEventListener('mousemove', (e) => {
      const rect = card.getBoundingClientRect();
      const centerX = rect.left + rect.width / 2;
      const centerY = rect.top + rect.height / 2;
      const angleX = (e.clientY - centerY) / 25;
      const angleY = (e.clientX - centerX) / 25;
      card.style.transform = `scale(1.05) rotateX(${-angleX}deg) rotateY(${angleY}deg)`;
    });

    card.addEventListener('mouseleave', () => {
      card.style.transform = 'scale(1) rotateX(0) rotateY(0)';
    });
  </script>
</body>
</html>
